import {Callout, Tab, Tabs} from "nextra-theme-docs";

# SkinsRestorer API

SkinsRestorer has a public API that can be used by other plugins to interact with SkinsRestorer.

<Callout type="warning" emoji="ðŸš¨">
    Please note that this API is still work-in-progress. Expect breaking changes!
</Callout>

## Resources

You can find useful resources to the SkinsRestorer API below:

* [Example Plugin](https://github.com/SkinsRestorer/SkinsRestorerAPIExample)
* [Javadocs](https://jd.skinsrestorer.net)

## Add to your build file

Here is an example of how to add the API to your build file. Select your build tool below.

Latest Version (Without the v):
![Latest Version](https://img.shields.io/github/v/tag/SkinsRestorer/SkinsRestorerX?label=version)

<Tabs items={['Maven', 'Gradle (Groovy)', 'Gradle (Kotlin)']}>
    <Tab>
        Add the following repository and dependency to your `pom.xml` file:

        ```xml
        <repositories>
            <repository>
                <id>codemc</id>
                <url>https://repo.codemc.org/repository/maven-public/</url>
            </repository>
        </repositories>

        <dependencies>
            <!-- SkinsRestorer API -->
            <dependency>
                <groupId>net.skinsrestorer</groupId>
                <artifactId>skinsrestorer-api</artifactId>
                <version>VERSION</version>
                <scope>provided</scope>
            </dependency>
        </dependencies>
        ```
    </Tab>
    <Tab>
        Add the following repository and dependency to your `build.gradle` file:

        ```groovy
        repositories {
            maven {
                name 'codemc'
                url 'https://repo.codemc.org/repository/maven-public/'
            }
        }

        dependencies {
            // SkinsRestorer API
            compileOnly 'net.skinsrestorer:skinsrestorer-api:VERSION'
        }
        ```
    </Tab>
    <Tab>
        Add the following repository and dependency to your `build.gradle.kts` file:

        ```kotlin
        repositories {
            maven("https://repo.codemc.org/repository/maven-public/") {
                name = "codemc"
            }
        }

        dependencies {
            // SkinsRestorer API
            compileOnly("net.skinsrestorer:skinsrestorer-api:VERSION")
        }
        ```
    </Tab>
</Tabs>

## When using BungeeCord/Velocity?

If you are using BungeeCord/Velocity, you must have a plugin that calls the API on BungeeCord/Velocity.
You would need to use in/out put channels to send this information across both of your custom plugins.

Getting issues?

* Make sure to import the `net.skinsrestorer.api.SkinsRestorerAPI` & `net.skinsrestorer.api.PlayerWrapper` in your
code (see example code)
* Make sure to get the API using `skinsRestorerAPI = SkinsRestorerAPI.getApi()`  and define by
adding `private SkinsRestorerAPI skinsRestorerAPI;` at the start of your class.
* If you don't know that the issue is causing, include a try catch, so you can print our exceptions using e.print... etc

## Using Plugin Message Channel

If you are using BungeeCord/Velocity, and you want your plugin to work from spigot. You could use [*Plugin Message
Channel*](https://www.spigotmc.org/wiki/bukkit-bungee-plugin-messaging-channel/) to send the commands to bungee cord.

### Messages list

`sr:messagechannel` is only to "forward" commands from spigot to bungee.
This includes cooldown, permissions checks and always sends feedback to player.
If you want to run it as a console (without checks), you will have to wait for `sr:adminchannel`

To Proxy:

| Message (sr:messagechannel +) |
|:-----------------------------:|
|      setSkin p skin/url       |
|          clearSkin p          |
|         getSkins page         |

To Bukkit:

|                    Message                    |
|:---------------------------------------------:|
|          sr:messagechannel OPENGUI p          |
| sr:skinchange SkinUpdate name value signature |

### Sending a message

First, you need to register the channel (on startup)

```java
Bukkit.getMessenger().registerOutgoingPluginChannel(this, "sr:messagechannel");
```

Example of how we send `/skin set <player> <skin>` over a plugin message channel:

```java
try {
  ByteArrayOutputStream bytes = new ByteArrayOutputStream();
  DataOutputStream out = new DataOutputStream(bytes);

  out.writeUTF("setSkin");
  out.writeUTF(p.getName());
  out.writeUTF(skin);

  p.sendPluginMessage(this, "sr:messagechannel", bytes.toByteArray());
} catch (IOException e) {
  e.printStackTrace();
}
```
